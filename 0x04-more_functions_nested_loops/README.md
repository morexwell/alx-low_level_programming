functions and nested nested loop
